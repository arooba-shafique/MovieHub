{% extends 'movies/base.html' %}

{% block content %}
<h2 class="text-2xl mb-4">Search Movies</h2>

<div class="mb-4">
    <input type="text" id="searchInput" placeholder="Search movies..." 
        class="p-2 rounded w-full text-black">
</div>

<div id="movies" class="grid grid-cols-3 gap-4"></div>

<script>
document.getElementById('searchInput').addEventListener('input', async e => {
    const query = e.target.value;
    const res = await fetch(`/api/movies/search/?q=${query}`);
    const data = await res.json();
    const container = document.getElementById('movies');
    container.innerHTML = '';
    data.forEach(movie => {
        const div = document.createElement('div');
        div.className = 'bg-gray-700 p-2 rounded cursor-pointer';
        div.innerHTML = `
            <img src="${movie.poster_url}" class="w-full rounded">
            <h3 class="text-lg mt-2">${movie.title}</h3>
        `;
        div.onclick = () => {
            window.location.href = `/movies/${movie.id}/`;
        };
        container.appendChild(div);
    });
});
</script>
{% endblock %}
